# セキュリティルール

## 禁止事項

- **本番操作の直接実行禁止**: デプロイコマンドは提示のみ
- **秘匿情報のコミット禁止**: `.env`, `credentials.json`, APIキー等
- **危険なコマンド禁止**: `rm -rf`, `chmod 777`, `osascript`

---

## 実行可能な操作

| 操作 | 許可 |
|------|------|
| `git add/commit/push` | ✅ |
| `gh issue/pr` | ✅ |
| ローカル開発サーバー起動 | ✅ |
| ローカルテスト実行 | ✅ |
| デプロイコマンド | ❌ コマンド提示のみ |
| 本番DB操作 | ❌ 禁止 |

---

## 本番操作が必要な場合

以下のように**コマンドを提示**し、ユーザーが実行する：

```markdown
以下のコマンドを実行してください：

\`\`\`bash
# デプロイ
<deploy_command>
\`\`\`

⚠️ 本番環境への操作となります。実行前に確認してください。
```

---

## コード品質

### Rust

- **SQLインジェクション対策**: SQLxのパラメータバインディング使用
- **エラーハンドリング**: `unwrap()`の乱用禁止、適切な`Result`/`Option`処理
- **入力検証**: ユーザー入力の検証とサニタイズ

### TypeScript/React

- **XSS対策**: ユーザー入力のエスケープ、`dangerouslySetInnerHTML`の禁止
- **型安全性**: `any`型の使用禁止
- **認証・認可**: 適切なアクセス制御の実装

---

## 機密情報の取り扱い

- **環境変数で管理**: コードにハードコードしない
- **`.env`ファイル**: `.gitignore`に含める
- **ログ出力**: 機密情報がログに出力されていないか確認

主要な環境変数:
- `FRONTEND_PORT`
- `BACKEND_PORT`
- `HOST`
- `DATABASE_URL`

---

## セキュリティレビュー観点

| 観点 | チェック内容 |
|------|-------------|
| 入力検証 | ユーザー入力の検証とサニタイズ |
| 認証 | 適切な認証メカニズム |
| 認可 | リソースへのアクセス制御 |
| データ保護 | 機密データの暗号化 |
| ログ | 機密情報がログに出力されていないか |
| 依存関係 | 既知の脆弱性を持つパッケージがないか |

---

## 依存関係のセキュリティ

```bash
# Rust依存関係の監査
cargo audit

# npm依存関係の監査
pnpm audit
```

---

## インシデント対応

セキュリティ問題を発見した場合:

1. **即座に報告**: ユーザーに通知
2. **作業停止**: 問題が解決するまで該当機能の実装を中断
3. **修正提案**: 安全な実装方法を提案
